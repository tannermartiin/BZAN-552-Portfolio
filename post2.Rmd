---
title: "Golf Clustering - Post 2"
author: "Tanner Martin"
date: "November 29, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## BASEBALL HITTERS CLUSTERING - POST 1


GET A SUMMARY OF THE DATA TO EXPLORE THE DATA - LOOKS MOST OF THE DATA IS NUMERIC EXCEPT FOR PLAYER NAMES.THIS DATA IS PROBABLY VERY USEFUL TO CREATE MEANINGUL CLUSTERS OF PLAYERS THAT WE CAN "DESCRIBE"
```{r cars}

Hitters <- read.csv("Hitters.csv")
summary(Hitters)

```

WE CAN CREATE A BATTING AVERAGE
```{r cars}

Hitters$BatAvg <- Hitters$Hits/Hitters$AtBat
hist(Hitters$BatAvg)

```

I'M ONLY GOING TO CONSIDER NUMERICAL VARIABLES IN THIS CASE. WE ALSO, FOR SIMPLISITY SAKE, ARE GOING TO TAKE OUT ROWS WHERE WE HAVE MISSING VALUES
```{r cars}

Hitters <- Hitters[,-c(14,15,20)]
Hitters <- Hitters[complete.cases(Hitters),]

```

WE HAVE DATA ON HITTERS FROM THIS PAST SEASON AS WELL OVER THE ENTIRETY OF THEIR CAREER. BECAUSE WE WANT TO GET A MORE HOLISITIC PICTURE OF THE PLAYERS AND HOW THEY HAVE SIMILARITIES, I'M GOING TO NOT INCLUDE ANY OF THE DATA ON THEIR PERFORMANCE RECENTLY AND JUST LOOK WHOLISTICLY AT THEIR CAREERS
```{r cars}

names(Hitters)
Hitters <- Hitters[,-c(1:6)]

```

WE NEED TO SCALE THE DATA SO THAT BIGGER VARIABLE DIFFERENCES AREN'T DOMINATING THE ANALYSIS
```{r cars}

Hitters.scale <- scale(Hitters)
summary(Hitters.scale)

```

NOW LETS DEPLOY K MEANS CLUSTERING ON THE DATA TO SEE IF WE CAN FIND ANYTHING INTERESTING. WHAT IS THE BEST NUMBER OF CLUSTERS TO USE? THERE'S NO RIGHT ANSWER HERE BUT WE CAN MAKE A GOOD GUESS BY LOOKING AT THEIR SSE AS THE NUMBER OF CLUSTERS GOES UP
```{r cars}

SSEs <- rep(NA,19) # a vector to store SSEs for different k's
for(k in 2:20){
    fit <- kmeans(Hitters.scale,k)
    SSEs[k] <- fit$tot.withinss
}
par(mar=c(4,4,1,1))

plot(1:20,SSEs,type="b",xlab="Number of Clusters")

```

I DON'T SEE A CUT AND DRY RIGHT ANSWER FOR THE NUMBER OF K LIKE I HAD HOPED TO SEE. THERE'SE REALLY NO "ELBOW" THAT PEOPLE TEND TO LOOK FOR WHEN DOING THIS. I THINK 10 IS A REASONABLE NUMBER HERE WITHOUT GETTING TOO COMPLICATED. THERE'S OFTEN A BALANCE BETWEEN PERFORMANCE AND INTERPRETABILITY WITH THIS BECAUSE THERE'S NO CUT AND DRY ANSWER. IT LOOKS LIKE 7 COULD BE A REASONABLE NUMBER OF CLUSTERS. 
```{r cars}

fit <- kmeans(Hitters.scale,7)
fit$size
fit$centers

```

WE CAN VIEW A HEAT MAP OF THE CLUSTERS WHICH CAN ALLOW US TO LOOK AT THINGS VISUALLY INSTEAD OF METHODICALLY LOOKING AT THE NUMBERS
```{r cars}

clusters <- fit$centers
HM <- heatmap(clusters, Rowv=NA, Colv=NA, scale="column")
legend("topleft", legend=c("BelowAvg", "AboveAvg"),
       fill=c("red", "Yellow"),pch=15 ,cex=0.8, bg=c("grey"), horiz=F, inset=.87)

```

CAN WE DESCRIBE THE CLUSTERS? IS THERE ANYTHING INTERESTING HERE THAT IS APPARENT?

CLUSTER 1 - APPEARS TO BE PLAYERS THAT HAVE PLAYED A LONG TIME WHO HAVE A LARGE NUMBER OF AT BATS AND HENCE NUMBER OF HITS, HMRUNS, ETC. THESE HITTERS LOOK TO BE MORE POWER HITTERS (A LOT OF HOMERUNS THAN ANY OTHER GROUP). THEY HAVE A LOWER BATTING AVERAGE WHICH MAKES SENSE (POWER HITTERS TEND TO STRIKE OUT MORE)

CLUSTER 2 - YOUNGER PLAYERS THAT SEEM TO BE GOOD AT FIELDING (NOT AS MANY ERRORS). HOWEVER, THIS GROUP IS A DECENT HITTING HITTING GROUP ALTHOUGH THEY HAVEN'T PLAYED FOR A VERY LONG TIME

CLUSTER 3 - YOUNGER PLAYERS SO THEY NATURALLY HAVE A LOWER AMOUNT OF CAREER HITTING STATS. THEY HAVE A VERY GOOD BATTING AVERAGE COMPARED TO THE OVERALL POPULATION AND LOWER AMOUNT OF ERRORS (WHICH IS A GOOD THING!)

CLUSTER 4 - THIS GROUP IS PRETTY MIDDLE OF THE ROAD OVERALL - THIS COULD POSSIBLY BE GROUP OF BACKUPS WHO AREN'T ALLSTARS BUT A GOOD WHEN THEY NEED TO FILL IN

CLUSTER 5 - THESE ARE THE THIRD OLDEST GROUP OF PLAYERS (COMPARED TO CLUSTER 1 AND 6) AND THIS GROUP HAS A VERY HIGH BATTING AVERAGE (HIGHEST OUT OF ALL GROUPS). THEY HAVE ABOVE AVERAGE CAREER STATS BECASE OF HOW LONG THEY'VE BEEN PLAYING

CLUSTER 6 - A GROUP SIMILAR TO CLUSTER 1 THE BIGGEST DIFFERENCE WITH THIS GROUP IS THAT THEY ARE PAID MORE AND HAVE A HIGHER BATTING AVERAGE OVERALL

CLUSTER 7 - THIS GROUP IS A YOUNG GROUP WITH A LOT OF ERRORS AND A BAD BATTING AVERAGE. OVERALL, THIS IS THE WORST GROUP. THEY ARE YOUNG, HAVE ABOVER AVERAGE ERRORS, AND BELOW AVERAGE BATTING AVERAGE
